const fram = require('express');
const tes = fram();
const bodyParser = require('body-parser'); 
// const MongoClient =require('mongodb').MongoClient;
// const ObjectID = require('mongodb').ObjectID;
// const DBurl = "mongodb://127.0.0.1:27017/";
// const DBname = "sekolah";

// tes.use(bodyParser.urlencoded({extended: false}))
// let dbo = null;
// MongoClient.connect(DBurl,(error, db)=>{
//     if(error) throw error;
//     dbo = db.db(DBname);
// });


// //dg parameter
// tes.get('/rpl', (request, response)=>{
//     dbo.collection('rpl').find().toArray((error, res)=>{
//         if(error) throw error;
//         response.json(res);
//     })
// });

// tes.post('/rpl', (request,reponse)=>{
//     let namaSiswa = request.body.name;
//     let kelasSiswa = request.body.kelas;
//     let jurusanSiswa = request.body.jurusan;
//     dbo.collection('rpl').insertOne({
//         nama : namaSiswa,
//         kelas : kelasSiswa,
//         jurusan : jurusanSiswa
//     }), (err,res)=>{
//         if(!err){
//         reponse.json(res);
//         response.end("Data Berhasil Masuk");
//     }
//     else{
//         throw err;
//         }
//     }
// })
// dg endpoint

tes.post('/siswa', (req, res)=>{
    let namaSiswa = req.body.name;
    let alamat = req.body.address;
    res.end('menampilkan siswa baru '+namaSiswa+', yang beralamat di '+alamat);
});


tes.delete('/siswa/:id', (req, res)=>{
    let id = req.params.id;
    let namaSiswa = req.body.name;
    res.end('id '+id+' telah dihapus, dengan nama : '+namaSiswa);
});

tes.put('/siswa/:id', (req,res)=>{
    let id = req.params.id;
    let namaSiswa = req.body.nama;
    let alamat = req.body.alamat;
    res.end('Siswa dengan id : '+id+' telah diupdate');
});

tes.listen('8080', (e)=>{
    console.log(e);
});